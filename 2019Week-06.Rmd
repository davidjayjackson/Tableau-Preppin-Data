---
title: 'Chin and Beard Shop: 2019 Week 6'
author: "David Jackson"
date: "11/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(scales)
library(janitor)
library(readxl)
```

## Soap Sales Profits

####  The Scenario:
Chin & Beard Suds Co (C&BS Co.) is looking to update their company data table which details the monthly profit generated by each product in Scotland and England. This has already been done for the first three months of 2019 for Scotland, but the March sales information for England has yet to be aggregated and added to the master table.

```{r}
rm(list = ls())
company <- read_excel("./Data/2019Week6Input.xlsx",sheet ="Company")
sales <- read_excel("./Data/2019Week6Input.xlsx",sheet ="Sales")
cost <- read_excel("./Data/2019Week6Input.xlsx",sheet ="cost")
```
```{r}
company <- clean_names(company)
sales <- clean_names(sales)
cost <- clean_names(cost)
cost <- cost %>% rename(category = type_of_soap)
sales$category <- gsub("Bar Soap","Bar",sales$category)
sales$category <- gsub("Liquid Soap","Liquid",sales$category)

march_sales <- left_join(sales,cost)
```

### Calculate Soap Sales

```{r}


march_sales$total_cost <- march_sales$units_sold * march_sales$manufacturing_cost_per_unit

march_sales$total_sales <- march_sales$units_sold *  march_sales$selling_price_per_unit

march_sales$profit <- march_sales$total_sales - march_sales$total_cost

```
```{r}
march_summary <-march_sales %>% select(date,country,category,profit)
```
```{r}
company_updated <- rbind(company,march_summary)
company_updated$category <- gsub("Bar Soap","Bar",company_updated$category)
company_updated$category <- gsub("Liquid Soap","Liquid",company_updated$category)
company_updated$category <- gsub("Liquid soap","Liquid",company_updated$category)

```

## Total Profit by Month

```{r}
company_updated %>% group_by(date) %>%
    summarise(total_profit = sum(profit)) %>%
  ggplot(aes(x=date,y=total_profit)) +
  geom_col()
```

```{r}
company_updated %>% group_by(country,date) %>%
    summarise(total_profit = sum(profit)) %>%
  ggplot(aes(x=date,y=total_profit)) +
  geom_col() + facet_wrap(~country)
```

```{r}
company_updated %>% group_by(category,date) %>%
    summarise(total_profit = sum(profit)) %>%
  ggplot(aes(x=date,y=total_profit)) +
  geom_col(aes(fill=category)) +
  labs(title = "Total Profits by Soap Category",
       x= "Sales Month",y="Profit in Dollars")
```
